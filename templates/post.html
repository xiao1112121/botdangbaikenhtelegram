<!doctype html>
<html lang="vi">
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>ÄÄƒng bÃ i</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary mb-4">
      <div class="container-fluid">
        <a class="navbar-brand" href="/">Dashboard</a>
      </div>
    </nav>
    <div class="container">
      <h3>ğŸ“ ÄÄƒng bÃ i lÃªn kÃªnh</h3>
      <div class="mb-3">
        <label class="form-label" for="content">Ná»™i dung</label>
        <textarea id="content" class="form-control" rows="6" placeholder="Nháº­p ná»™i dung... há»— trá»£ shortcode [fire] â†’ ğŸ”¥"></textarea>
      </div>
      <div class="mb-3">
        <label class="form-label" for="channelSelect">Chá»n kÃªnh</label>
        <select id="channelSelect" class="form-select" multiple size="6">
          {% for ch in channels %}
            <option value="{{ ch.id }}">{{ ch.name }} ({{ ch.id }})</option>
          {% endfor %}
        </select>
        <div class="form-text">Giá»¯ Ctrl (Windows) hoáº·c âŒ˜ (Mac) Ä‘á»ƒ chá»n nhiá»u kÃªnh</div>
      </div>
      <button class="btn btn-success" onclick="sendPost()">ğŸš€ Gá»­i bÃ i</button>
      <div id="result" class="mt-3"></div>
    </div>

    <script>
      async function sendPost(){
        const content = document.getElementById('content').value;
        const select = document.getElementById('channelSelect');
        const channels = Array.from(select.selectedOptions).map(o=>o.value);
        if(!content){alert('Vui lÃ²ng nháº­p ná»™i dung!');return;}
        if(channels.length===0){alert('Chá»n Ã­t nháº¥t má»™t kÃªnh');return;}
        const res = await fetch('/post/send',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({content:content,channels:channels})});
        const data = await res.json();
        document.getElementById('result').innerHTML = `<pre>${JSON.stringify(data,null,2)}</pre>`;
      }
    </script>
  </body>
</html> 